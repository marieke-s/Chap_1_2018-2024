#------------- Description ---------------------
# Purpose: 
# This script aims to compute covariables associated to eDNA replicates. The covariables in this script come from : 
# vector computation 
# extraction from rasters 

# The expected result is a csv file with all original metedata info and a supplementary covariables columns each eDNA replicate.

# Data source: 
# Raster files of predictor (see data section for details)
# A subselection of metadata of the mediterranean eDNA samples grouped by replicates (see 1_Prep_Mtdt.R for details).

# Author: Marieke Schultz

# Contributors : Marie Orblin (script MPA)

# Date script created: 25/07/2025

#------------- Setting up ------------------
# Remove existing objects
rm(list = ls())

# Set current working directory
setwd("/media/marieke/Shared/Chap-1/Model/Scripts/Chap_1_2018-2024")

# Libraries
library(dplyr)
library(sf)
library(raster)
library(ncdf4)
library(lubridate)
library(terra)
library(stringr)





#------------- Load mtdt ------------------ 
buff <- st_read("./data/processed_data/eDNA/mtdt_5.gpkg")
b <- st_read("./data/processed_data/eDNA/mtdt_3.gpkg")

#------------- Vector data ----------------
############## Sampling effort ############
# Explanation : the aim is to variables that represent the sampling effort in each replicate group : 
# Total volume filtered in the replicate group
#